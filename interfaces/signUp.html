<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">

  
  <title>Sakancom SignUp</title>
  <link href="../resources/public_html/assets/img/loyintlogos/logow.svg" rel="icon">


  <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css'>
  <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.css'><link rel="stylesheet" href="../multi-step-form/dist/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">



</head>



<body>


<nav class="navbar navbar-default navbar-trans navbar-expand-lg fixed-top " style="position: absolute">
  <div class="container">
    <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarDefault"
            aria-controls="navbarDefault" aria-expanded="false" aria-label="Toggle navigation">
      <span></span>
      <span></span>
      <span></span>
    </button>
    <a href="../../index.html" class="logo">
      <img src="../multi-step-form/dist/Screenshot_2023-07-02_at_13.13.32-removebg.png" alt="" style="width: 250px;  ">
    </a>
    <button type="button" class="btn btn-link nav-search navbar-toggle-box-collapse d-md-none" data-toggle="collapse"
            data-target="#navbarTogglerDemo01" aria-expanded="false">
      <span class="fa fa-search" aria-hidden="true"></span>
    </button>
    <div class="navbar-collapse collapse justify-content-center" id="navbarDefault">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="../Houses/index.html" style="margin-left: 700px; margin-right: 5px; font-size: 20px ">Home</a>
        </li>
      </ul>
    </div>

  </div>
</nav>





<!-- partial:index.partial.html -->
<div class="container-fluid" style="padding-top: 10rem;">
  <div class="row justify-content-center">
    <div class="col-11 col-sm-10 col-md-10 col-lg-6 col-xl-5 text-center p-0 mt-3 mb-2">
      <div class="card px-0 pt-4 pb-0 mt-3 mb-3">
        <h2 id="heading">Create your account!</h2>
        <p>Fill all form field to go to next step</p>
        <form id="msform">
          <!-- progressbar -->
          <ul id="progressbar">
            <li class="active" id="account"><strong>Account</strong></li>
            <li id="personal"><strong>Personal</strong></li>
            <li id="payment"><strong>Information</strong></li>
            <li id="confirm"><strong>Finish</strong></li>
          </ul>
          <div class="progress">
            <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div>
          </div> <br> <!-- fieldsets -->
          <fieldset>
            <div class="form-card">
              <div class="row">
                <div class="col-7">
                  <h2 class="fs-title">Account Information:</h2>
                </div>
                <div class="col-5">
                  <h2 class="steps">Step 1 - 4</h2>
                </div>

              </div> <label class="fieldlabels">Email: *</label> <input type="email" id="email" name="email" placeholder="Email Id" oninput="validateEmail()" required/> <p id="emailError" style="color: red"></p> <label class="fieldlabels">Password: *</label> <input type="password" id="pwd" name="pwd" placeholder="Password" required/> <label class="fieldlabels">Confirm Password: *</label> <input type="password" id="confirmPwd" name="confirmPwd" placeholder="Confirm Password" required/>


              <script>
                function validateEmail() {
                  var email = document.getElementById("email").value;
                  var re = /\S+@\S+\.\S+/;
                  var errorElement = document.getElementById("emailError");

                  if (re.test(email)) {
                    errorElement.textContent = 'Valid email address';
                    errorElement.style.color = 'green';
                    return true;
                  } else {
                    errorElement.textContent = 'Invalid email address';
                    errorElement.style.color = 'red';
                    return false;
                  }
                }
              </script>

              
              <span id="message" ></span>
              <script>
                document.getElementById('confirmPwd').addEventListener('input', function () {
                  var passwordInput = document.getElementById('pwd');
                  var confirmPasswordInput = document.getElementById('confirmPwd');
                  var message = document.getElementById('message');

                  if (passwordInput.value !== confirmPasswordInput.value) {
                    message.textContent = 'Passwords do not match';
                    message.style.color = 'red';
                  } else {
                    message.textContent = 'Passwords match';
                    message.style.color = 'green';
                  }
                });
              </script>

            </div>   <input type="button" name="next" class="next action-button" value="Next" id="nextButton5" disabled />
            <script>
              var nextButtonTimeout; // Variable to store the timeout ID

              // Function to check if all required fields are valid
              function validateForm() {
                // Clear the previous timeout, if any
                clearTimeout(nextButtonTimeout);

                var email = document.getElementById("email");
                var pwd = document.getElementById("pwd");
                var confirmPwd = document.getElementById("confirmPwd");

                // Check if both password fields are equal
                var passwordsMatch = pwd.value === confirmPwd.value;
                var validemail=validateEmail();
                // Check if all required fields have valid values
                var allFieldsValid =
                        validemail &&
                        pwd.reportValidity() &&
                        confirmPwd.reportValidity() &&
                        passwordsMatch;

                // Enable/disable the "Next" button based on the form's validation status after a small delay
                nextButtonTimeout = setTimeout(function () {
                  var nextButton = document.getElementById("nextButton5");
                  nextButton.disabled = !allFieldsValid;
                }, 200); // Set a 200ms delay (adjust as needed)
              }

              // Call the validateForm function whenever any input field loses focus
              document.getElementById("email").addEventListener("blur", validateForm);
              document.getElementById("pwd").addEventListener("blur", validateForm);
              document.getElementById("confirmPwd").addEventListener("blur", validateForm);

              // Call the validateForm function whenever any password field value changes

            </script>




          </fieldset>

          <fieldset id="Two">
            <div class="form-card">
              <div class="row">
                <div class="col-7">
                  <h2 class="fs-title">Personal Information:</h2>
                </div>
                <div class="col-5">
                  <h2 class="steps">Step 2 - 4</h2>
                </div>
              </div> <label class="fieldlabels">First Name: *</label> <input type="text" name="fname" id="fname"placeholder="First Name" required /> <label class="fieldlabels">Last Name: *</label> <input type="text" name="lname" id="lname" placeholder="Last Name" required /> <label class="fieldlabels">Contact No.: *</label> <input type="text" name="phno" id="phone" placeholder="Contact No." required/> <label class="fieldlabels">Alternate Contact No.: *</label> <input type="text" name="phno_2" id="phone2" placeholder="Alternate Contact No." required/>

            </div> <input type="button" name="next" class="next action-button" value="Next" id="nextButton2" disabled /> <input type="button" name="previous" class="previous action-button-previous" value="Previous" />
            <script>
              var nextButtonTimeout; // Variable to store the timeout ID

              // Function to check if all required fields are valid
              function validateForm() {
                // Clear the previous timeout, if any
                clearTimeout(nextButtonTimeout);

                var fn = document.getElementById("fname");
                var ln = document.getElementById("lname");
                var phone2 = document.getElementById("phone2");
                var phone = document.getElementById("phone");

                // Check if all required fields have valid values
                var allFieldsValid =
                        fn.reportValidity() &&
                        ln.reportValidity() &&
                        phone2.reportValidity() &&
                        phone.reportValidity();

                // Enable/disable the "Next" button based on the form's validation status after a small delay
                nextButtonTimeout = setTimeout(function () {
                  var nextButton = document.getElementById("nextButton2");
                  nextButton.disabled = !allFieldsValid;
                }, 200); // Set a 200ms delay (adjust as needed)
              }

              // Call the validateForm function whenever any input field loses focus
              document.getElementById("fname").addEventListener("blur", validateForm);
              document.getElementById("lname").addEventListener("blur", validateForm);
              document.getElementById("phone2").addEventListener("blur", validateForm);
              document.getElementById("phone").addEventListener("blur", validateForm);
            </script>


          </fieldset>

          <fieldset>
            <div class="form-card">
              <div class="row">
                <div class="col-7">
                  <h2 class="fs-title">Informations:</h2>
                </div>
                <div class="col-5">
                  <h2 class="steps">Step 3 - 4</h2>
                </div>

              <label class="fieldlabels">University Major:*</label> <input type="text" name="major" id="Major" placeholder="University Major" required />
              <label class="fieldlabels">Work Place:*</label>
              <select id="workplace" name="workplace" class="form-control" style="background-color: #ECEFF1;" >

                <option value="Student">Student</option>
                <option value="Employee">Employee</option>
              </select>

                <label class="fieldlabels">Age:*</label>
                <input
                        type="number"
                        name="age"
                        id="age"
                        placeholder="Enter Your Age:"
                        pattern="\d{1,2}"
                        maxlength="2"
                        oninput="validateAge()"
                        oninvalid="this.setCustomValidity('Age must be between 1 and 100.')"
                        required
                />
                <span id="ageMessage"></span>

                <script>
                  function validateAge() {
                    var ageInput = document.getElementById("age");
                    var age = parseInt(ageInput.value);

                    if (age >= 1 && age <= 100) {
                      ageInput.setCustomValidity(""); // Clear any previous custom validity message
                    } else {
                      ageInput.setCustomValidity("Age must be between 1 and 100.");
                    }
                  }
                </script>



                <label class="fieldlabels">Type:*</label>
              <select id="Type" name="Type" class="form-control "  style="background-color: #ECEFF1;">
                <option value="tenant">Tenant</option>
                <option value="owner">Owner</option>


              </select>

                <script>
                  var UserType;

                  document.getElementById('Type').addEventListener('change', function() {
                    UserType = this.value === 'tenant' ? 0 : 1;
                    console.log(UserType); //for testing purposes
                  });
                </script>
            </div> <input type="button" name="next" class="next action-button" value="Submit" id="nextButton" disabled /><input type="button" id="previous2" name="previous" class= " action-button-previous" value="Previous" />
              <script>
                var nextButtonTimeout; // Variable to store the timeout ID

                // Function to check if all required fields are valid
                function validateForm() {
                  // Clear the previous timeout, if any
                  clearTimeout(nextButtonTimeout);

                  var major = document.getElementById("Major");
                  var age = document.getElementById("age");


                  // Check if all required fields have valid values
                  var allFieldsValid =
                          major.reportValidity() &&

                          age.reportValidity();

                  // Enable/disable the "Next" button based on the form's validation status after a small delay
                  nextButtonTimeout = setTimeout(function () {
                    var nextButton = document.getElementById("nextButton");
                    nextButton.disabled = !allFieldsValid;
                  }, 200); // Set a 200ms delay (adjust as needed)
                }

                // Call the validateForm function whenever any input field loses focus
                document.getElementById("Major").addEventListener("blur", validateForm);
                document.getElementById("age").addEventListener("blur", validateForm);
              </script>
              <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
              <script>
                $('#previous2').click(function() {
                  // Change the view to the #two fieldset
                  location.href = "";
                });
              </script>
            </div>
          </fieldset>
          <fieldset>
            <div class="form-card" >
              <div class="row">
                <div class="col-7">
                  <h2 class="fs-title">Finish:</h2>
                </div>
                <div class="col-5">
                  <h2 class="steps">Step 4 - 4</h2>
                </div>
              </div> <br><br>
              <h2 class="purple-text text-center"><strong>SUCCESS !</strong></h2> <br>
              <div class="row justify-content-center">
                <div class="col-3"> <img src="truesign.jpg" class="fit-image"> </div>
              </div> <br><br>
              <div class="row justify-content-center">
                <div class="col-7 text-center">
                  <h5 class="purple-text text-center" style="font-size: 1000px">You Have Successfully Signed Up</h5>
                </div>
              </div>
            </div>
          </fieldset>
        </form>
      </div>
    </div>
  </div>
</div>
<footer class="footer-distributed" >

  <div class="footer-left">

    <a  class="logo">
      <img src="Screenshot_2023-07-02_at_13.13.32-removebg.png" alt="" style="width: 250px;  ">
    </a>



    <p class="footer-company-name" style="color: #FFFFFF;padding-top: 3rem ">Sakancom Â© 2015</p>
  </div>

  <div class="footer-center">

    <div>
      <i class="fa fa-map-marker"></i>
      <p><span>Rafedyia Street</span> Nablus, Palestine</p>
    </div>

    <div>
      <i class="fa fa-phone"></i>
      <p>+972595254709</p> </br>
      <p style="padding-left: 4.5rem">+970598666558</p>
    </div>

    <div>
      <i class="fa fa-envelope"></i>
      <p><a href="mailto:yossalam261@gmail.com">yossalam261@gmail.com</a></p></br>
      <p style="padding-left: 4.5rem"><a href="mailto:mohammadaker7@gmail.com">mohammadaker7@gmail.com</a></p>
    </div>

  </div>

  <div class="footer-right">

    <p class="footer-company-about">
      <span>About the company</span>
      Sakancom offers a diverse range of rental properties to suit every budget. With a commitment to service and transparency, we make finding your perfect home easy and enjoyable
    </p>

    <div class="footer-icons">

      <a href="https://www.facebook.com/yusuf.salam.568/"><i class="fa fa-facebook"></i></a>
      <a href="https://twitter.com/YoSSalam2"><i class="fa fa-twitter"></i></a>
      <a href="https://www.linkedin.com/in/yossalam8/"><i class="fa fa-linkedin"></i></a>
      <a href="https://github.com/YoSSalam8"><i class="fa fa-github"></i></a>

    </div>

  </div>

</footer>
<!-- partial -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script><script  src="../multi-step-form/dist/script.js"></script>

<script>
  $(document).ready(function(){
    $(".action-button").click(function(){
      if($(this).val() === "Submit"){

        var email = $("input[name='email']").val();
        var pwd = $("input[name='pwd']").val();
        var cpwd = $("input[name='cpwd']").val();
        var fname = $("input[name='fname']").val();
        var lname = $("input[name='lname']").val();
        var phno = $("input[name='phno']").val();
        var phno_2 = $("input[name='phno_2']").val();
        var major = $("input[name='major']").val();
        var workplace = $("#workplace").val();
        var age = $("input[name='age']").val();
        var userType =  document.getElementById('Type').selectedIndex;


        var checkEmailUrl = "http://localhost:9090/user/checkUserExistence";
        var addUser="http://localhost:9090/user/saveUser";


        var checkEmailData = {
          email: email
        };


        var formData = {
          email: email,
          password: pwd,
          firstName: fname,
          lastName: lname,
          phoneNumber: phno,
          alternatePhoneNumber: phno_2,
          universityMajor: major,
          workPlace: workplace,
          age: age,
          userType: userType
        };





        $.ajax({
          data: checkEmailData,
          url: checkEmailUrl,

          type: "GET",
          success: function(response) {
            var responseData = response;
            console.log(responseData)

            if(responseData===true){
              console.log("email exists")

            }
            else{
              console.log("success email")

              $.ajax({
                data: JSON.stringify(formData),
                url: addUser,
                contentType: "application/json; charset=utf-8", // Set the content type to JSON
                type: "POST",
                success: function (data) {
                  console.log('Form submitted successfully. Returned data: ', data);
                },
                error: function (request, status, error) {
                  console.error();
                }
              });
            }





          },
          error: function(error) {
            console.log(Error);
          }
        });










      }
    });
  });
</script>


</body>
</html>
